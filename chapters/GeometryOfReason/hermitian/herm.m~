a=[1/3;1/3;1/3];
b=[1/2;1/4;1/4];
c=[2/5;2/5;1/5];
# D=[0,dkl(a,b),dkl(a,c);dkl(b,a),0,dkl(b,c);dkl(c,a),dkl(c,b),0]
# D=[0,euc(a,b),euc(a,c);euc(b,a),0,euc(b,c);euc(c,a),euc(c,b),0]
D=[0,2,3;3,0,1;-1,2,0]
S=0.5*(D+D')
T=0.5*(D-D')
H=S+i.*T
[U,Ll] = eig(H)
disp("Notice that H=U*L*U-conjugate transpose.");
disp("U(r):");
UR=real(U)
disp("U(i):");
UI=imag(U)
X=[
   UR(1,1),UR(1,2),UR(1,3),UI(1,1),UI(1,2),UI(1,3);
   UR(2,1),UR(2,2),UR(2,3),UI(2,1),UI(2,2),UI(2,3);
   UR(3,1),UR(3,2),UR(3,3),UI(3,1),UI(3,2),UI(3,3)]
OS=[
   Ll(1,1),Ll(1,2),Ll(1,3),0,0,0;
   Ll(2,1),Ll(2,2),Ll(2,3),0,0,0;
   Ll(3,1),Ll(3,2),Ll(3,3),0,0,0;
   0,0,0,Ll(1,1),Ll(1,2),Ll(1,3);
   0,0,0,Ll(2,1),Ll(2,2),Ll(2,3);
   0,0,0,Ll(3,1),Ll(3,2),Ll(3,3)]
OK=[
   0,0,0,-Ll(1,1),-Ll(1,2),-Ll(1,3);
   0,0,0,-Ll(2,1),-Ll(2,2),-Ll(2,3);
   0,0,0,-Ll(3,1),-Ll(3,2),-Ll(3,3);
   Ll(1,1),Ll(1,2),Ll(1,3),0,0,0;
   Ll(2,1),Ll(2,2),Ll(2,3),0,0,0;
   Ll(3,1),Ll(3,2),Ll(3,3),0,0,0]

aa1=(D(2,1)+D(1,2))/2;
aa2=(D(3,1)+D(1,3))/2;
aa3=(D(3,2)+D(2,3))/2;
bb1=(D(2,1)-D(1,2))/(-2);
bb2=(D(3,1)-D(1,3))/(-2);
bb3=(D(3,2)-D(2,3))/(-2);
ap=aa1*((aa2*aa3)+(bb2*bb3));
app=bb1*((aa2*bb3)-(bb2*aa3));

coef1=(-1)*(((aa3^2)+(bb3^2))+((aa2^2)+(bb2^2))+((aa1^2)+(bb1^2)))
coef2=(-1)*((2*ap)-(2*app))

A=[UR(1,1)+i*UI(1,1);UR(1,2)+i*UI(1,2);UR(1,3)+i*UI(1,3)]
B=[UR(2,1)+i*UI(2,1);UR(2,2)+i*UI(2,2);UR(2,3)+i*UI(2,3)]
C=[UR(3,1)+i*UI(3,1);UR(3,2)+i*UI(3,2);UR(3,3)+i*UI(3,3)]












